app:
  enabled: true # enabled by default
  image:
    repository: containers.catalystsquad.com/public/reactorcide/coordinator
    pullPolicy: Always
    # Overrides the image tag whose default is the chart appVersion
    tag: "dev"
  prometheus:
    enabled: false
    path: /metrics
    port: 9000
    latencyHistogramsEnabled: true
  service:
    type: ClusterIP
    port: 6080
  # Gateway API HTTPRoute configuration (routes /api/* to coordinator)
  gateway:
    enabled: false
    # List of domains to create HTTPRoutes for
    domains: []
    # Example:
    # domains:
    #   - reactorcide.example.com
    # Name of the Gateway resource to attach to
    gatewayName: ""
    # Namespace of the Gateway (optional, defaults to same namespace)
    gatewayNamespace: ""
    # Section name on the Gateway (listener name)
    sectionName: "https"
    # Additional annotations for the HTTPRoute
    annotations: {}
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 10
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80
  replicaCount: 1
  commitOnSuccess: true
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 128Mi

web:
  enabled: false # disabled by default
  image:
    repository: containers.catalystsquad.com/public/reactorcide/web
    pullPolicy: IfNotPresent
    # Overrides the image tag whose default is the chart appVersion
    tag: "dev"
  service:
    type: ClusterIP
    port: 4080
  apiUrl: "http://reactorcide-coordinator-api-service:6080"
  # Gateway API HTTPRoute configuration (routes /* to web UI)
  gateway:
    enabled: false
    # List of domains to create HTTPRoutes for
    domains: []
    # Example:
    # domains:
    #   - reactorcide.example.com
    # Name of the Gateway resource to attach to
    gatewayName: ""
    # Namespace of the Gateway (optional, defaults to same namespace)
    gatewayNamespace: ""
    # Section name on the Gateway (listener name)
    sectionName: "https"
    # Additional annotations for the HTTPRoute
    annotations: {}
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 5
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 80
  replicaCount: 1
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 50m
      memory: 64Mi

worker:
  enabled: true
  image:
    repository: containers.catalystsquad.com/public/reactorcide/worker
    pullPolicy: Always
    tag: "dev"
  replicaCount: 1
  queue: "reactorcide-jobs"
  pollInterval: 5  # seconds
  concurrency: 2    # concurrent jobs per worker pod
  dryRun: false
  autoscaling:
    enabled: false
    minReplicas: 1
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  livenessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 30
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 3
  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 512Mi

grpc:
  maxMessageSizeBytes: "1000000000"

postgres:
  uri: postgresql://devuser:devpass@reactorcide-postgresql:5432/reactorcide?sslmode=disable

# Corndogs task queue configuration
# Disabled by default - users should provide their own Corndogs in production
corndogs:
  enabled: false  # Set to true to deploy Corndogs subchart
  # External Corndogs URL - used when subchart is disabled but you have external Corndogs
  baseUrl: ""  # e.g., "http://corndogs.example.com:5080"
  # Disable bitnami postgresql in corndogs subchart
  postgresql:
    enabled: false
  # Our custom postgres:18 deployment for Corndogs (separate from bitnami)
  customPostgresql:
    enabled: false  # Disabled by default
    image:
      repository: postgres
      tag: "18"
      pullPolicy: IfNotPresent
    auth:
      username: "corndogs"
      password: "corndogs"
      database: "corndogs"
    persistence:
      enabled: false
      size: 10Gi
      storageClass: ""
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 128Mi
  # Database connection for Corndogs (points to our postgres deployment)
  # Uses 'database' key to match corndogs chart expectations
  database:
    dbname: "corndogs"
    host: "reactorcide-corndogs-postgresql"
    user: "corndogs"
    password: "corndogs"
  # Service configuration
  service:
    port: 5080

# Object storage configuration
# WARNING: Job logs are stored here. The default 'filesystem' type is for DEVELOPMENT ONLY.
# Logs will be LOST when pods restart since there is no persistent volume for filesystem storage.
# For production, you MUST configure 's3' or 'gcs' type with appropriate credentials below.
objectStore:
  type: filesystem  # Options: filesystem, s3, gcs, memory (filesystem is dev-only!)
  bucket: reactorcide-objects
  basePath: /tmp/reactorcide-objects  # For filesystem type (ephemeral - dev only)
  prefix: reactorcide/  # For s3/gcs types
  s3:
    accessKeyId: ""
    secretAccessKey: ""
    region: us-east-1
    endpoint: ""  # Leave empty for AWS S3, set for S3-compatible services
  gcs:
    serviceAccountJson: ""

# Default configuration
defaults:
  queueName: reactorcide-jobs
  timeout: 3600  # seconds
  # Default runner image for jobs that don't specify one
  # Set this to your registry's runnerlib image (e.g., "registry.example.com/reactorcide/runner:latest")
  runnerImage: ""
  userId: ""  # UUID for default user (optional - auto-generated if not set)
  # Secret name for default user credentials (userId and API token)
  # This secret is auto-created with a generated userId on first install
  # The deploy script adds the API token after user creation
  userSecretName: "base-reactorcide-user"

storage:
  type: postgres

# Secrets management configuration
# Database storage is the default and recommended for multi-tenant deployments.
# Local storage is only for single-user CLI deployments.
secrets:
  # Storage type: "database" (default), "local", or "none" to disable
  storageType: database
  # Master keys for encryption. Format: "name1:base64key1,name2:base64key2"
  # First key in the list is the primary key used for new encryptions.
  # Generate a key with: openssl rand -base64 32
  # IMPORTANT: In production, set this via external secret management, not in values.yaml
  masterKeys: ""  # e.g., "mk-2026-01:K7xZ9pQrStUvWxYz1234567890ABCDEF"
  # Reference an existing Kubernetes secret containing REACTORCIDE_MASTER_KEYS
  existingSecret: ""  # e.g., "reactorcide-master-keys"
  existingSecretKey: "master-keys"  # Key within the existing secret

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

# You could give a service account per service, but this is simpler for most use cases
# We did add _helpers entries to make this an easy exercise for the reader
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The base name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# The rest of these are also pretty standard, but are not implemented as separate template
# entries for simplicity reasons. These are for advanced security cases and for deployment
# styles you should avoid.
podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000


nodeSelector: {}

tolerations: []

affinity: {}

# Bundled PostgreSQL - disabled by default
# Users should provide their own PostgreSQL in production
# Enable only for local development or testing
postgresql:
  enabled: false  # Disabled by default - use your own PostgreSQL
  image:
    repository: postgres
    tag: "18"
    pullPolicy: IfNotPresent
  auth:
    username: "devuser"
    password: "devpass"
    database: "reactorcide"
  persistence:
    enabled: false  # Disabled by default for dev environments
    size: 10Gi
    storageClass: ""  # Use default storage class
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 256Mi
